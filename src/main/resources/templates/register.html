<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <title>Title</title>-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1">-->
<!--    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"-->
<!--          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">-->
<!--</head>-->
<!--<body>-->

<!--<div class="text-center">-->
<!--    <h1>Your User List</h1>-->
<!--</div>-->
<!--<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#addUser" data-whatever="@mdo">Add user</button>-->
<!--<div class="container">-->
<!--    <table id="user_table" class="table table-striped table-bordered"></table>-->
<!--</div>-->

<!--<div class="modal fade" id="addUser" tabindex="-1" aria-labelledby="#addUserLabel" aria-hidden="true">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title" id="addUserLabel"></h5>-->
<!--                <form id="register">-->
<!--                    <h2 class="text-center">Log in</h2>-->
<!--                    <div class="container" >-->
<!--                    <div class="form-group "  align="center">-->
<!--                        <input id="name" type="text" class="control-input col-sm-20" placeholder="Username" required="required">-->
<!--                    </div>-->
<!--                    <div class="form-group"  align="center">-->
<!--                        <input id="email" type="text" class="control-input col-sm-20" placeholder="Email" required="required">-->
<!--                    </div>-->
<!--                    <div class="form-group" align="center">-->
<!--                        <input id="age" type="text" class="control-input col-sm-20" placeholder="Age" required="required">-->
<!--                    </div>-->
<!--                    <div class="form-group" align="center">-->
<!--                        <input id="phone" type="text" class="control-input col-sm-20" placeholder="Phone" required="required">-->
<!--                    </div>-->
<!--                    <div class="form-group" align="center">-->
<!--                        <input id="password" type="password" class="control-input col-sm-20" placeholder="Password"-->
<!--                               required="required">-->
<!--                    </div>-->
<!--                    </div>-->
<!--                    <div class="form-group" align="center">-->
<!--                        <input type="submit" value="addUser">-->
<!--                    </div>-->

<!--                </form>-->

<!--                <button class="btn close" data-dismiss="modal" aria-label="close">x</button>-->
<!--            </div>-->
<!--            <div class="modal-body">-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!--<div class="modal fade" id="updateUser" tabindex="-1" aria-labelledby="#updateUserLabel" aria-hidden="true">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title" id="updateUserLabel">Form for editUser</h5>-->
<!--                <button class="btn close" data-dismiss="modal" aria-label="close"></button>-->
<!--            </div>-->
<!--            <div class="modal-body">-->
<!--                <form id="update">-->
<!--                    <div class="container" >-->
<!--                        <div class="form-group "  align="center">-->
<!--                            <input id="addName" type="text" class="control-input col-sm-20" placeholder="Username" required="required">-->
<!--                        </div>-->
<!--                        <div class="form-group"  align="center">-->
<!--                            <input id="addEmail" type="text" class="control-input col-sm-20" placeholder="Email" required="required">-->
<!--                        </div>-->
<!--                        <div class="form-group" align="center">-->
<!--                            <input id="addAge" type="text" class="control-input col-sm-20" placeholder="Age" required="required">-->
<!--                        </div>-->
<!--                        <div class="form-group" align="center">-->
<!--                            <input id="addPhone" type="text" class="control-input col-sm-20" placeholder="Phone" required="required">-->
<!--                        </div>-->
<!--                        <div class="form-group" align="center">-->
<!--                            <input id="addPassword" type="password" class="control-input col-sm-20" placeholder="Password"-->
<!--                                   required="required">-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="form-group" align="center">-->
<!--                        <input type="submit" value="updateUser">-->
<!--                    </div>-->
<!--                </form>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!--   <script >-->

<!--       async function getAllUsers() {-->
<!--           let response = await fetch('http://localhost:8000/api/users/')-->
<!--           let content = await response.json()-->
<!--               .then(users =>{-->
<!--                   let li = `-->
<!--            <tr>-->
<!--            <th scope="col">id</th>-->
<!--            <th scope="col">name</th>-->
<!--            <th scope="col">email</th>-->
<!--            <th scope="col">age</th>-->
<!--            <th scope="col">phone</th>-->
<!--            <th scope="col">password</th>-->
<!--            <th scope="col">update</th>-->
<!--            <th scope="col">delete</th>-->
<!--            </tr>`;-->
<!--                   users.forEach(user => {-->
<!--                       li += `-->
<!--                <tr>-->
<!--                <td>${user.id}</td>-->
<!--                <td id="nameValue${user.id}">${user.name}</td>-->
<!--                <td id="emailValue${user.id}">${user.email}</td>-->
<!--                <td id="ageValue${user.id}">${user.age}</td>-->
<!--                <td id="phoneValue${user.id}">${user.phone}</td>-->
<!--                <td id="passwordValue${user.id}">${user.password}</td>-->
<!--                <td><button onclick="getUserdata(${user.id})" class="btn btn-outline-success" data-toggle="modal" data-target="#updateUser">edit</button>-->
<!--</td>-->
<!--                <td data-id="${user.id}"><a href="#" class="card-link" id="delete-user" >delete</a></td>-->

<!--                </tr>`-->
<!--                   });-->
<!--                   document.getElementById("user_table").innerHTML = li;-->
<!--               })-->
<!--       }-->
<!--       getAllUsers()-->

<!--       const table = document.querySelector('table')-->
<!--       let url = 'http://localhost:8000/api/users';-->
<!--       let form = document.getElementById('register');-->
<!--       form.addEventListener('submit', function (e) {-->
<!--           e.preventDefault()-->
<!--           let id = document.getElementById('editId').value;-->
<!--           let name = document.getElementById('name').value;-->
<!--           let email = document.getElementById('email').value;-->
<!--           let age = document.getElementById('age').value;-->
<!--           let phone = document.getElementById('phone').value;-->
<!--           let password = document.getElementById('password').value;-->

<!--           fetch('api/users',{-->
<!--               method: 'POST',-->
<!--               body: JSON.stringify({-->
<!--                   id:id,-->
<!--                   name:name,-->
<!--                   email:email,-->
<!--                   age:age,-->
<!--                   phone:phone,-->
<!--                   password:password-->
<!--               }),-->
<!--               headers:{-->
<!--                   "Content-Type":"application/json"-->
<!--               }-->
<!--           })-->
<!--               .then(function (response) {-->
<!--                   return response.json()-->
<!--               })-->
<!--               .then(function (data) {-->
<!--                   console.log(data)-->
<!--               })-->
<!--           setTimeout(test,100);-->
<!--           function test() {-->
<!--               document.location.href = 'http://localhost:8000'-->
<!--           }-->
<!--       })-->
<!--       table.addEventListener('click', (e) => {-->
<!--           e.preventDefault();-->
<!--           let delButtonIsPressed = e.target.id === 'delete-user';-->
<!--           let userId = e.target.parentElement.dataset.id;-->
<!--           if (delButtonIsPressed) {-->
<!--               fetch(`${url}/${userId}`, {-->
<!--                   method: 'DELETE'-->
<!--               }).then(res => res.text())-->
<!--                   .then(() => location.reload())-->
<!--           }-->
<!--       })-->
<!--       let editForm = document.getElementById('update');-->
<!--       let urlEdit = 'http://localhost:8000/api/users'-->
<!--       editForm.addEventListener('submit', function (e) {-->
<!--           e.preventDefault();-->
<!--           let id = document.getElementById-->
<!--           let name = document.getElementById('editName').value-->
<!--           let email = document.getElementById('editEmail').value-->
<!--           let age = document.getElementById('editAge').value-->
<!--           let phone = document.getElementById('editPhone').value-->
<!--           let password = document.getElementById('editPassword').value-->
<!--           fetch(urlEdit, {-->
<!--               method: 'PUT',-->
<!--               body: JSON.stringify({-->
<!--                   id: id,-->
<!--                   name: name,-->
<!--                   email:email,-->
<!--                   age:age,-->
<!--                   phone:phone,-->
<!--                   password: password-->
<!--               }),-->
<!--               headers: {-->
<!--                   "Content-Type":"application/json"-->
<!--               }-->
<!--           }).then(function (response) {-->
<!--               return response.json()-->
<!--           }).then(function (data) {-->
<!--               console.log(data)-->
<!--           })-->
<!--           setTimeout(test,100);-->
<!--           function test() {-->
<!--               document.location.href = 'http://localhost:8000/'-->
<!--           }-->
<!--       })-->
<!--        function getUserdata(idUser) {-->
<!--        document.getElementById('editId').value = idUser;-->
<!--        document.getElementById('editName').value = $('nameValue' + idUser).text();-->
<!--        document.getElementById('editEmail').value = $('emailValue' + idUser).text();-->
<!--        document.getElementById('editAge').value = $('ageValue' + idUser).text();-->
<!--        document.getElementById('editPhone').value = $('phoneValue' + idUser).text();-->
<!--        document.getElementById('editPassword').value = $('passwordValue' + idUser).text();-->

<!--        }-->

<!--   </script>-->
<!--<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"-->
<!--        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"-->
<!--        crossorigin="anonymous"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"-->
<!--        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"-->
<!--        crossorigin="anonymous"></script>-->
<!--<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"-->
<!--        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"-->
<!--        crossorigin="anonymous"></script>-->
<!--</body>-->
<!--</html>-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>index</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

</head>
<body>
<!--<button class="btn btn-outline-success" data-toggle="modal" data-target="admin">Admin page</button>-->
<button class="btn btn-outline-success" data-toggle="modal" data-target="#addUser">Add new user</button>
<button class="btn btn-outline-success" data-toggle="modal" data-target="#"><a href="/user">User page</a></button>


<div class="container">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <ul class="nav navbar-nav">
                <li class="nav-item">
                </li>
                <br>
                <li class="nav-item">
                </li>
                <li class="nav-item">
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/login">logout</a></li>
            </ul>
        </div>
    </nav>

    <div class="text-center">
        <h1>Users table</h1>
    </div>
    <div class="container">
        <table id="users_table" class="table table-hover table-striped">


        </table>
    </div>

</div>
<!--Modal-->
<div class="modal fade" id="addUser" tabindex="-1" aria-labelledby="#addUserLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addUserLabel">Form</h5>
                <button class="btn close" data-dismiss="modal" aria-label="close">x</button>
            </div>
            <div class="modal-body">
                <form id="add" method="post">
                    <div class="form-group" align="center">
                        <label for="name">Name</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="name" placeholder="Name" required="name">
                    </div>
                    <div class="form-group" align="center">
                        <label for="email">email</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="email" placeholder="email" required="email">
                    </div>
                    <div class="form-group" align="center">
                        <label for="age">Age</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="age" placeholder="age" required="age">
                    </div>
                    <div class="form-group" align="center">
                        <label for="phone">Phone</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="phone" placeholder="phone" required="phone">
                    </div>
                    <div class="form-group" align="center">
                        <label for="password">Password</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="password" placeholder="Password" required="password">
                    </div>
                    <div class="form-group" align="center">
                        <input type="submit" value="addUser">
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<!--Modal-->

<!--    form for update user-->

<!--Modal-->
<div class="modal fade" id="updateUser" tabindex="-1" aria-labelledby="#updateUserLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="updateUserLabel">Form for editUser</h5>
                <button class="btn close" data-dismiss="modal" aria-label="close"></button>
            </div>
            <div class="modal-body">
                <form id="update">
                    <div class="form-group" align="center">
                        <label for="editId">id</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="editId" placeholder="id">
                    </div>
                    <div class="form-group" align="center">
                        <label for="name">Name</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="editName" placeholder="name">
                    </div>
                    <div class="form-group" align="center">
                        <label for="email">email</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="editEmail" placeholder="email">
                    </div>
                    <div class="form-group" align="center">
                        <label for="age">Age</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="editAge" placeholder="age">
                    </div>
                    <div class="form-group" align="center">
                        <label for="editPhone">Phone</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="editPhone" placeholder="phone">
                    </div>
                    <div class="form-group" align="center">
                        <label for="password">Password</label>
                        <br>
                        <input type="text" class="control-input col-sm-10" id="editPassword" placeholder="Password">
                    </div>
                    <div class="form-group" align="center">
                        <input type="submit" value="updateUser">
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>            // получение всех пользоватедей

async function getAllUsers() {
    let response = await fetch('http://localhost:8000/api/users')
    let content = await response.json()
        .then(users => {
            let li = `
            <tr>
            <th scope="col">id</th>
            <th scope="col">name</th>
            <th scope="col">email</th>
            <th scope="col">phone</th>
            <th scope="col">age</th>
            <th scope="col">update</th>
            <th scope="col">delete</th>
            </tr>`;
            users.forEach(u => {
                li += `
                <tr>
                <td>${u.id}</td>
                <td id="nameValue${u.id}">${u.name}</td>
                <td id="emailValue${u.id}">${u.email}</td>
                <td id="phoneValue${u.id}">${u.phone}</td>
                <td id="ageValue${u.id}">${u.age}</td>
                <td><button onclick="getUserdata(${u.id})" class="btn btn-outline-success" data-toggle="modal" data-target="#updateUser">edit</button>
</td>
                <td data-id="${u.id}"><a href="#" class="card-link" id="delete-user" >delete</a></td>

                </tr>`
            });
            document.getElementById("users_table").innerHTML = li;
        })
}
getAllUsers()

// новый пользователь

const table = document.querySelector('table')
let url = 'http://localhost:8000/api/users';
let form = document.getElementById('add');
form.addEventListener('submit', function (e) {
    e.preventDefault()
    let name = document.getElementById('name').value
    let email = document.getElementById('email').value
    let age = document.getElementById('age').value
    let phone = document.getElementById('phone').value
    let password = document.getElementById('password').value

    fetch('http://localhost:8000/api/users', {
        method: 'POST',
        body: JSON.stringify({
            name: name,
            email: email,
            age: age,
            phone:phone,
            password: password
        }),
        headers: {
            "Content-Type":"application/json"
        }
    })
        .then(function (response) {
            return response.json()
        })
        .then(function (data) {
            console.log(data)
        })
    setTimeout(test,100);
    function test() {
        document.location.href = 'http://localhost:8000/'
    }
})

// method edit - delete

table.addEventListener('click', (e) => {
    e.preventDefault();
    let delButtonIsPressed = e.target.id === 'delete-user';
    let userId = e.target.parentElement.dataset.id;
    if (delButtonIsPressed) {
        fetch(`${url}/${userId}`, {
            method: 'DELETE'
        }).then(res => res.text())
            .then(() => location.reload())
    }
})


let editForm = document.getElementById('update');
let urlEdit = 'http://localhost:8000/api/users'
editForm.addEventListener('submit', function (e) {
    e.preventDefault();
    let id = document.getElementById('editId').value
    let name = document.getElementById('editName').value
    let email = document.getElementById('editEmail').value
    let age = document.getElementById('editAge').value
    let phone = document.getElementById('editPhone').value
    let password = document.getElementById('editPassword').value
    fetch(urlEdit, {
        method: 'PUT',
        body: JSON.stringify({
            id: id,
            name: name,
            email: email,
            age: age,
            phone:phone,
            password: password
        }),
        headers: {
            "Content-Type":"application/json"
        }
    }).then(function (response) {
        return response.json()
    }).then(function (data) {
        console.log(data)
    })
    setTimeout(test,100);
    function test() {
        document.location.href = 'http://localhost:8000/'
    }
})

function getUserdata(idU) {
    document.getElementById('editId').value = idU;
    document.getElementById('editName').value = $('#nameValue' + idU).text();
    document.getElementById('editEmail').value = $('#emailValue' + idU).text();
    document.getElementById('editAge').value = $('#ageValue' + idU).text();
    document.getElementById('editPhone').value = $('#phoneValue' + idU).text();
    document.getElementById('editPassword').value = $('#passwordValue' + idU).text();
}

</script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>